<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Trackr</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-8">Media Trackr</h1>
        
        <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-md p-6">
            <div class="mb-6">
                <label for="url" class="block text-sm font-medium text-gray-700 mb-2">Enter URL to scrape:</label>
                <div class="flex gap-2">
                    <input type="url" id="url" 
                           class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
                           placeholder="https://example.com/article">
                    <button onclick="scrapeUrl()" 
                            class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                        Scrape
                    </button>
                </div>
            </div>

            <div id="loading" class="hidden text-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"></div>
                <p class="mt-2 text-gray-600">Scraping content...</p>
            </div>

            <div id="results" class="hidden">
                <h2 class="text-xl font-semibold mb-4">Scraped Content</h2>
                <div class="space-y-4">
                    <div>
                        <h3 class="font-medium text-gray-700">Title</h3>
                        <p id="title" class="text-gray-900"></p>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-700">Content</h3>
                        <p id="content" class="text-gray-900 whitespace-pre-wrap"></p>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-700">Author</h3>
                        <p id="author" class="text-gray-900"></p>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-700">Published Date</h3>
                        <p id="date" class="text-gray-900"></p>
                    </div>
                </div>
            </div>

            <div id="error" class="hidden text-red-600 mt-4"></div>
        </div>
    </div>

    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://torosdzdrwpnpyyzlslx.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRvcm9zZHpkcndwbnB5eXpsc2x4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ3OTU2NDEsImV4cCI6MjA2MDM3MTY0MX0.sqUleF89MAKAYn_CCRFEWjm3iesNrxD3p8zU_PySyHo';
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);
        
        const FIRECRAWL_API_KEY = 'fc-262aba9b9ddd4266bc9168d162677792';
        
        async function scrapeUrl() {
            const url = document.getElementById('url').value;
            if (!url) {
                showError('Please enter a URL');
                return;
            }

            showLoading();
            hideError();
            hideResults();

            try {
                const { data, error } = await supabase
                    .rpc('scrape_article', {
                        url: url,
                        selectors: {
                            title: 'h1',
                            content: 'article',
                            author: '.author, .byline',
                            date: 'time[datetime], .date'
                        }
                    });

                if (error) {
                    throw new Error(error.message);
                }

                displayResults(data);
            } catch (error) {
                showError('Error scraping URL: ' + error.message);
                console.error('Scraping error:', error);
            } finally {
                hideLoading();
            }
        }

        function displayResults(data) {
            document.getElementById('title').textContent = data.title || 'Not found';
            document.getElementById('content').textContent = data.content || 'Not found';
            document.getElementById('author').textContent = data.author || 'Not found';
            document.getElementById('date').textContent = data.date || 'Not found';
            document.getElementById('results').classList.remove('hidden');
        }

        function showLoading() {
            document.getElementById('loading').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loading').classList.add('hidden');
        }

        function showError(message) {
            document.getElementById('error').textContent = message;
            document.getElementById('error').classList.remove('hidden');
        }

        function hideError() {
            document.getElementById('error').classList.add('hidden');
        }

        function hideResults() {
            document.getElementById('results').classList.add('hidden');
        }
    </script>
</body>
</html> 